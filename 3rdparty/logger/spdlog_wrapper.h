#ifndef __spdlog_wrapper_h__
#define __spdlog_wrapper_h__

#define SPDLOG_ACTIVE_LEVEL SPDLOG_LEVEL_TRACE
#include <spdlog/spdlog.h>

#ifndef _WIN32
    #include <experimental/filesystem>
    namespace fs = std::experimental::filesystem;
#else
    #include <filesystem>
    namespace fs = std::filesystem;
#endif

#include <sstream>

namespace owc {
namespace logging {

using namespace spdlog;

using Logger = spdlog::logger;
using LoggerPtr = std::shared_ptr<spdlog::logger>;
using Prefix = std::string;

void init(const fs::path& filePath, Prefix prefix = "owc",
          size_t maxSize = 20 * 1024 * 1024,
          std::chrono::seconds flushEvery = std::chrono::seconds{3});
void deinit();
LoggerPtr createCategory(Prefix name, LoggerPtr logger = nullptr);
LoggerPtr createLogger(const fs::path& filePath, Prefix prefix,
                       size_t maxSize = 20 * 1024 * 1024,
                       size_t maxFileCount = 1);
const fs::path& getDefaultLogDir();
std::string encrypt(const std::string_view& text);

}  // namespace logging
}  // namespace owc

#define OWC_LOG_INFO(loggerPtr, ...) \
  if (loggerPtr) SPDLOG_LOGGER_INFO(loggerPtr, __VA_ARGS__)

#define OWC_LOG_WARN(loggerPtr, ...) \
  if (loggerPtr) SPDLOG_LOGGER_WARN(loggerPtr, __VA_ARGS__)

#define OWC_LOG_ERROR(loggerPtr, ...) \
  if (loggerPtr) SPDLOG_LOGGER_ERROR(loggerPtr, __VA_ARGS__)

#define OWC_LOG_CRITICAL(loggerPtr, ...) \
  if (loggerPtr) SPDLOG_LOGGER_CRITICAL(loggerPtr, __VA_ARGS__)

#define OWC_LOG_DEBUG(loggerPtr, ...) \
  if (loggerPtr) SPDLOG_LOGGER_DEBUG(loggerPtr, __VA_ARGS__)

#define OWC_LOG_TRACE(loggerPtr, ...) \
  if (loggerPtr) SPDLOG_LOGGER_TRACE(loggerPtr, __VA_ARGS__)

#define OWC_LPINFO(prefix, ...) \
  SPDLOG_LOGGER_INFO(owc::logging::createCategory(prefix), __VA_ARGS__)

#define OWC_LPWARN(prefix, ...) \
  SPDLOG_LOGGER_WARN(owc::logging::createCategory(prefix), __VA_ARGS__)

#define OWC_LPERROR(prefix, ...) \
  SPDLOG_LOGGER_ERROR(owc::logging::createCategory(prefix), __VA_ARGS__)

#define OWC_LPCRITICAL(prefix, ...) \
  SPDLOG_LOGGER_CRITICAL(owc::logging::createCategory(prefix), __VA_ARGS__)

#define OWC_LPDEBUG(prefix, ...) \
  SPDLOG_LOGGER_DEBUG(owc::logging::createCategory(prefix), __VA_ARGS__)

#define OWC_LPTRACE(prefix, ...) \
  SPDLOG_LOGGER_TRACE(owc::logging::createCategory(prefix), __VA_ARGS__)

#define OWC_INFO SPDLOG_INFO
#define OWC_WARN SPDLOG_WARN
#define OWC_ERROR SPDLOG_ERROR
#define OWC_CRITICAL SPDLOG_CRITICAL
#define OWC_DEBUG SPDLOG_DEBUG
#define OWC_TRACE SPDLOG_TRACE

#endif