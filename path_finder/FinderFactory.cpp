#include "FinderFactory.h"
#ifndef _WIN32    
    #include <linux/MemoryFinderCore.h>
    #include <linux/OesisFinderCore.h>
    #include <linux/RegularFinderCore.h>
#else
// #include <malware_scan/path_finder/FinderFactory.h>
// #include <malware_scan/path_finder/MemoryFinderCore.h>
// #include <malware_scan/path_finder/OesisFinderCore.h>
// #include <malware_scan/path_finder/RegularFinderCore.h>
#endif

namespace owc {
namespace finder {
PathFinder* FinderFactory::createFinder(
    Type finderType, const Paths& multiPath, FoundCallback foundCallback,
    std::shared_ptr<std::recursive_mutex> mtx) {
  auto finder = createFinder(finderType, foundCallback, mtx);
  finder->setPathToFind(multiPath);
  return finder;
}

PathFinder* FinderFactory::createFinder(
    Type finderType, const Path& path, FoundCallback foundCallback,
    std::shared_ptr<std::recursive_mutex> mtx) {
  auto finder = createFinder(finderType, foundCallback, mtx);
  finder->setPathToFind(path);
  return finder;
}

PathFinder* FinderFactory::createFinder(
    Type finderType, FoundCallback foundCallback,
    std::shared_ptr<std::recursive_mutex> mtx) {
  auto finder = createFinder(finderType, mtx);
  finder->registerFoundCallback(foundCallback);
  return finder;
}

PathFinder* FinderFactory::createFinder(
    Type finderType, std::shared_ptr<std::recursive_mutex> mtx) {
  switch (finderType) {
    // case Type::oesis:
    //   return new OesisFinderCore(mtx);
    case Type::memory:
      return new MemoryFinderCore(mtx);
    // default:
      // return new RegularFinderCore(mtx);
  }
}
}  // namespace finder
}  // namespace owc
