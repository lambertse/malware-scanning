#pragma once
// #include <shared/core/ExportDef.h>
// #include <malware_scan/path_finder/PathFinder.h>

#include "PathFinder.h"
#include "FinderDefines.h"

namespace owc {
namespace finder {

class FinderFactory {
 public:
  FinderFactory() = delete;
  ~FinderFactory() = delete;

  static PathFinder* createFinder(
      Type finderType, const Paths& multiPath, FoundCallback foundCallback = {},
      std::shared_ptr<std::recursive_mutex> mtx = nullptr);
  static PathFinder* createFinder(
      Type finderType, const Path& path, FoundCallback foundCallback = {},
      std::shared_ptr<std::recursive_mutex> mtx = nullptr);
  static PathFinder* createFinder(
      Type finderType, FoundCallback foundCallback,
      std::shared_ptr<std::recursive_mutex> mtx = nullptr);
  static PathFinder* createFinder(
      Type finderType = Type::regular,
      std::shared_ptr<std::recursive_mutex> mtx = nullptr);
};

}  // namespace finder
}  // namespace owc
