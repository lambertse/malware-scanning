#ifndef __ms_defines_h__
#define __ms_defines_h__

using ms_wstring = std::wstring;
using ms_int     = int;
using ms_uint    = unsigned int;
using ms_string  = std::string;
using ms_bool    = bool;

enum FileScanConclusion{
  NoThreatDetected = 0,
  Infected = 1,
  Suspicious = 2,
  Failed = 3,
  CleanedDeleted = 4,
  Unknown = 5,
  Quarantined = 6,
  Whitelisted = 7,
  Blacklisted = 8,
  ExceededArchiveDepth = 9,
  NotScanned = 10,
  EncryptedArchive = 12,
  ExceededArchiveSize = 13,
  ExceededArchiveFileNumber = 14,
  PasswordProtectedDocument = 15,
  ExceededArchiveTimeout = 16,
  FiletypeMismatch = 17,
  PotentiallyVulnerableFile = 18,
  Canceled = 19,
  Sensitivedatafound = 20,
  YaraRuleMatched = 21,
  InProgress = 255,
  LP_LocalProcessResultStart = 1000,
  LP_ExceededFileSize = 1001
};

enum FileScanStatus {
  AllowedFile,
  BlockedFile,
  SkippedFile,
  VulnerableFile,
  ErrorFile
};

enum HashCheckType{
  CheckHashAndUpload = 0,
  UploadOnly = 1,
  CheckHashOnly = 2
};

#define MS_LOG_FILENAME                     "malwarescan.log"
#define MS_LOG_TAG                          "malware-scan"

#define MS_QUERY_TIME                     10ms
#define MS_THREAD_COUNT                   10
#define MS_MAX_ALLOWED_UPLOAD_THREAD      5
#define MS_BLOCKED                          L"Blocked"

#define MS_KEY_REQUEST_HEADER               L"req_header"
#define MS_KEY_FILE_PATH                    L"file_path"
#define MS_KEY_FILE_SIZE                    L"file_size"
#define MS_KEY_MEDIA_SECURITY               L"media_security"
#define MS_KEY_MANIFEST                     L"manifest"
#define MS_KEY_ENABLED                      L"enabled"
#define MS_KEY_TRUSTED_D                    L"trusted_d"
#define MS_KEY_TRUSTED_ONLY_MANIFEST        L"trust_only_manifest"
#define MS_KEY_HASH                         L"hash"
#define MS_KEY_RESPONSE                     L"response"
#define MS_KEY_RESULT                       L"result"
#define MS_KEY_ERROR                        L"error"
#define MS_KEY_MESSAGES                     L"messages"
#define MS_KEY_ERR                          L"err"
#define MS_KEY_CODE                         L"code"
#define MS_KEY_API_KEY_INFO                 L"apikey_info"
#define MS_KEY_VALID_API_KEY                L"valid_apikey"
#define MS_KEY_API_KEY_LIMITS               L"apikey_limits"
#define MS_KEY_NO_REACH_LIMIT               L"no_reach_limit"
#define MS_KEY_SERVERS                      L"server"
#define MS_KEY_UPLOAD_RESPONSE              L"upload_response"
#define MS_KEY_DATA_ID                      L"data_id"
#define MS_KEY_DATA                         L"data"
#define MS_KEY_INFECT_ERR                   L"infect_error"
#define MS_KEY_ERROR_MSG                    L"error_msg"
#define MS_KEY_HTTP_CODE                    L"http_code"
#define MS_KEY_CURL_ERROR_CODE              L"curl_error_code"
#define MS_KEY_ERROR_DICT                   L"error_dict"
#define MS_KEY_INFECTED_FILES               L"infected_files"
#define MS_KEY_IGNORED_FILES                L"ignored_files"
#define MS_KEY_ST_PROC_TIME                 L"start_processing_time"
#define MS_KEY_END_PROC_TIME                L"end_processing_time"
#define MS_KEY_TOTAL_FILE                   L"total_file_count"
#define MS_KEY_COMPLETE_PERCENTAGE          L"complete_percentage"

#define MS_KEY_WORK_FLOW                    L"workflow"
#define MS_KEY_ARCHIVEPWD                   L"archivepwd"
#define MS_KEY_CONTENT_TYPE                 L"content-type"
#define MS_KEY_ACCEPT                       L"accept"
#define MS_KEY_EXPECT                       L"expect"
#define MS_KEY_USER_HOST_NAME               L"user-hostname"
#define MS_KEY_SOURCE                       L"source"
#define MS_KEY_CONNECTION                   L"connection"
#define MS_KEY_NAME                         L"name"
#define MS_KEY_ENGINE_NAME                  L"eng_name"
#define MS_KEY_DEF_TIME                     L"def_time"
#define MS_KEY_PATH                         L"path"
#define MS_KEY_TIME                         L"time"
#define MS_KEY_FILE_INFO                    L"file_info"
#define MS_KEY_SHA_256                      L"sha256"
#define MS_KEY_THREATS                      L"threats"
#define MS_KEY_PROC_INFO                    L"process_info"
#define MS_KEY_ENGINE_DEF_DATE              L"eng_def_date"
#define MS_KEY_SCAN_DETAIL                  L"scan_details"
#define MS_KEY_SCAN_RES                     L"scan_results"
#define MS_KEY_SCAN_RES_I                   L"scan_result_i"
#define MS_KEY_SCAN_ALL_RES_I               L"scan_all_result_i"
#define MS_KEY_THREAT_FOUND                 L"threat_found"
#define MS_KEY_EXPLA_MSG                    L"explanation_msg"
#define MS_KEY_COMPLETE_PERCENT             L"complete_percentage"
#define MS_KEY_START_TIME                   L"start_time"
#define MS_KEY_END_TIME                     L"end_time"
#define MS_KEY_TOTAL_VUL_FILE               L"total_vulnerable_files"
#define MS_KEY_TOTAL_SCANNED_FILE           L"total_files_scanned"
#define MS_KEY_TOTAL_INFECTED_FILE          L"total_infected_files"
#define MS_KEY_TOTAL_ALLOWED_FILE           L"total_allowed_files"
#define MS_KEY_PRCED_DATA_SIZE              L"processed_data_size"
#define MS_KEY_BATCH_ID                     L"batch_id"
#define MS_KEY_JOB_ID                       L"jobID"
#define MS_KEY_PROC_PERCENTAGE              L"progress_percentage"

//config keys
#define MS_KEY_SOT_CONFIG                   L"sot_config"
#define MS_KEY_CONFIG                       L"config"
#define MS_KEY_INTERVAL_S                   L"interval_s"
#define MS_KEY_WAITING_TIME                 L"waiting_time"
#define MS_KEY_INTERVAL                     L"interval"
#define MS_KEY_SCAN_OPTIONS                 L"scan_options"
#define MS_KEY_TYPE                         L"type"
#define MS_KEY_DONT_VERIFY_TLS              L"dont_verify_tls"
#define MS_KEY_FULLSCAN                     L"full_scan"
#define MS_KEY_AVAIL_SCANNERS               L"available_scanners"
#define MS_KEY_SERVER_ID                    L"server_id"
#define MS_KEY_URL                          L"url"
#define MS_KEY_VERSION                      L"version"
#define MS_KEY_CONNECTED                    L"connected"
#define MS_KEY_API_KEY                      L"apikey"
#define MS_KEY_API_KEY_CONFIG               L"api_key"
#define MS_KEY_SCAN_RULE                    L"scan_rule"
#define MS_KEY_SCAN_RULES                   L"scan_rules"
#define MS_KEY_USER_AGENT                   L"user_agent"
#define MS_KEY_RULE                         L"rule"
#define MS_KEY_INCLUDE_ENGINES              L"include_engines"
#define MS_KEY_ENGINE_THRESHOLD             L"engine_threshold"
#define MS_KEY_SCANNING_POLICY              L"scanning_policy"
#define MS_KEY_DISABLE_HASH_CHECK           L"disable_hash_check"
#define MS_KEY_ACTION_RESULT                L"action_result"
#define MS_KEY_EVENT                        L"event"
#define MS_KEY_EXPLANATION_RESULT           L"explanation_result"


#define MS_KEY_CALLABLE_SET_FILEINFO        L"callable_set_fileinfo"
#define MS_KEY_CALLABLE_GET_FILEINFO        L"callable_get_fileinfo"

#define MS_PATH_LOCAL_DB_PATH               L"/usr/bin/opswatclient/malware-scanning/localhash.db"
#define MS_PATH_HASH_POST_FIX               L"/hash/"
#define MS_PATH_FILE_POST_FIX               L"/file/"

#define MS_MSG_UNABLE_REACH_SERVER          L"Unable to reach the MetaDefender server"
#endif


