#ifndef __ms_scan_task_h__
#define __ms_scan_task_h__

#include "ms_layers.h"
#include "msdict/ms_dict.h"

enum Status{
    VERIFY,
    MANIFEST,
    CDR,
    CALCULATE_HASH,
    CHECK_LOCAL_HASH,
    CHECK_SERVER_HASH, 
    UPLOADING,
    QUERY_RESULT,
};

class MSScanTask : public MalwareScanLayer {
public:
    MSScanTask(std::shared_ptr<MalwareScanLayer> srcSteps = nullptr, const MSDict& srcParam = nullptr) 
        : MalwareScanLayer(), 
        _layers(srcSteps),
        _param(srcParam)
    {
    }
    ms_rc start(const MSDict& inDict, MSDict& outDict) override;
private:
    ms_shared_layer_ptr _layers;
    MSDict _param;

};
#endif