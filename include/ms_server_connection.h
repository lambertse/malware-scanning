#ifndef __ms_server_connection_h__
#define __ms_server_connection_h__

#include "ms_return_codes.h"
#include "msdict/ms_dict.h"
#include "msdict/ms_json.h"
#include "ms_logger.h"
#include "ms_defines.h"
#include "ms_labels.h"
#include <cpr/cpr.h>

enum MDServerType{
    MDCloud = 0,
    MDCore  = 1
};
enum MDServerStatus {
    Scannable       =  0,
    EmptyAddress    = Scannable - 1,
    Disconnected    = Scannable - 2,
    InvalidApiKey   = Scannable - 3,
    LimitReached    = Scannable - 4
};

class MDServerConnection{
public:
    static ms_rc generateReqHeader(const MSDict& config, MSDict& desRqHeader, MSDict& additionalInfo);

    static ms_rc getServerStatus(const MSDict& config, MSDict& res);
    static ms_rc getApiVersion(const MSDict& reqHeader, const MSDict& inDict, MSDict& outDict);
    static ms_rc getApiKeyInfo(const MSDict& reqHeader, const MSDict& inDict, MSDict& outDict);
    static ms_rc getApiKeyLimit(const MSDict& reqHeader, const MSDict& inDict, MSDict& outDict);
    static ms_rc getScanRuleFromMDCore(const MSDict& reqHeader, const MSDict& inDict, MSDict& outDict);

    static ms_rc checkApiVersion(const MSDict& reqHeader, const MSDict& additionalInfo, MSDict& serverStatus, bool& res);
    static ms_rc checkApiKeyInfo(const MSDict& reqHeader, const MSDict& additionalInfo, MSDict& serverStatus, bool& res);
};

#endif