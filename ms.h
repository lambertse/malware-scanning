#ifndef __ms_h__
#define __ms_h__

#include "ms_engine.h"


MS_DECLSPEC class MalwareScanManager{
public:
    MalwareScanManager(ms_int srcEvent = 0) : _event(srcEvent){
        _engine = std::make_shared<MalwareScanEngine>(_event);
    }
    ~MalwareScanManager(){}

    static ms_wstring getScanResult();
    static ms_int getActionResult();
    static ms_wstring getExplanationResult();
    static ms_wstring getServerID();

private:
    static ms_shared_engine        _engine; 
    ms_int                         _event; //0: scheduler, 1: ondemand
    static MSDict                  _additionalData;
    static MSDict                  _scanResultData;
};

using ms_shared_manager = std::shared_ptr<MalwareScanManager>;

#endif