#include "ms.h"
#include "ms_defines.h"
MSDict MalwareScanManager::_additionalData = MSDict(MSDictType::NUL);
MSDict MalwareScanManager::_scanResultData = MSDict(MSDictType::NUL);
ms_shared_engine MalwareScanManager::_engine;

ms_wstring MalwareScanManager::getScanResult()
{
    if( MS_SUCCESS( _engine->init()) ){
        _engine->start();
    }
    _additionalData = std::move( _engine->getScanAdditionalData());
    _engine->deinit();
    return _engine->getScanResultData();
}

ms_int MalwareScanManager::getActionResult()
{
    ms_int action;
    if( !_additionalData.isNull() && MS_SUCCESS(_additionalData.val(MS_KEY_ACTION_RESULT, action ))){
        return action;
    }
    return 0;
}

ms_wstring MalwareScanManager::getExplanationResult()
{
    ms_wstring explanation;
    if( !_additionalData.isNull() && MS_SUCCESS(_additionalData.val(MS_KEY_EXPLANATION_RESULT, explanation ))){
        return explanation;
    }
    return L"";
}

ms_wstring MalwareScanManager::getServerID()
{
    ms_wstring serverID;
    if( !_additionalData.isNull() && MS_SUCCESS(_additionalData.val(MS_KEY_SERVER_ID, serverID ))){
        return serverID;
    }
    return L"";
}
