#ifndef __ms_layers_abstract_h__
#define __ms_layers_abstract_h__

#include "3rdparty/msdict/ms_dict.h"
#include "utils/string_utils.h"
#include <memory>
#include <iostream>
#include <thread>
#include <condition_variable>
#include <unordered_set>
#include <unordered_map>
#include <fstream>

using ms_ll = size_t;

class MalwareScanLayer;
using ms_shared_layer_ptr = std::shared_ptr<MalwareScanLayer>;

class MalwareScanLayer
{
public:
    MalwareScanLayer() : _nextStep(nullptr){}
    virtual ms_rc start(const MSDict& in_dict, MSDict& out_dict)
    {
        return this->_nextStep ? this->_nextStep->start(in_dict, out_dict) : MS_OK;
    }
    ms_shared_layer_ptr setNext(ms_shared_layer_ptr srcNext)
    {
        _nextStep = srcNext;
        return _nextStep;
    }

protected:
    ms_shared_layer_ptr _nextStep;

};


struct FileInfo
{
    std::string hash;
    std::string scanResults;
    int ttl = 0;
};

#endif