#ifndef __ms_layers_abstract_h__
#define __ms_layers_abstract_h__

#include "ms_dict.h"
#include "ms_return_codes.h"
#include "utils/string_utils.h"
#include <memory>
#include <iostream>
#include <thread>
#include <condition_variable>
#include <unordered_set>
#include <unordered_map>
#include <fstream>

using ms_ll = size_t;

class MalwareScanLayer;
using ms_shared_layer_ptr = std::shared_ptr<MalwareScanLayer>;

class MalwareScanLayer
{
public:
    MalwareScanLayer() : _nextStep(nullptr){}
    virtual ms_rc start(const MSDict& inDict, MSDict& outDict)
    {
        return this->_nextStep ? this->_nextStep->start(inDict, outDict) : MS_OK;
    }
    ms_shared_layer_ptr setNext(ms_shared_layer_ptr srcNext)
    {
        _nextStep = srcNext;
        return _nextStep;
    }
    ms_rc registerCallback(const ms_dict_callable& srcCb) { _callback = srcCb;}
protected:
    ms_shared_layer_ptr _nextStep;
    ms_dict_callable _callback;
};

#endif