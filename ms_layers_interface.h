#ifndef __ms_layers_interface_h__
#define __ms_layers_interface_h__

#include "shared/axzdict/axz_dict.h"

#include <memory>
#include <iostream>
#include <thread>

class MalwareScanLayer;
using ms_shared_layer_ptr = std::shared_ptr<MalwareScanLayer>;

class MalwareScanLayer
{
public:
    MalwareScanLayer() : _nextStep(nullptr){}
    virtual ms_rc start(const AxzDict& in_dict, AxzDict& out_dict)
    {
        // if(this->_nextStep != nullptr){
        //     return this->_nextStep->start(in_dict);
        // }
        // return in_dict;
        return this->_nextStep ? this->_nextStep->start(in_dict, out_dict) : MS_OK;
    }
    ms_shared_layer_ptr setNext(ms_shared_layer_ptr srcNext)
    {
        _nextStep = srcNext;
        return _nextStep;
    }

protected:
    ms_shared_layer_ptr _nextStep;

};


#endif