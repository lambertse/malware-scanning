
#ifndef __ms_engine_h__
#define __ms_engine_h__

#include "shared/axzdict/axz_dict.h"
#include "ms_return_codes.h"

#include <chrono>
#include <unordered_set>
#include <memory>


class FileScanResult
{
public:
    FileScanResult(){
        infectedList.become(AxzDictType::ARRAY);
        vulnerableList.become(AxzDictType::ARRAY);
        ignoredList.become(AxzDictType::ARRAY);
    }

    AxzDict infectedList;
    AxzDict vulnerableList;
    AxzDict ignoredList;
};

class MalwareScanEngine
{
public:
    MalwareScanEngine();
    ~MalwareScanEngine();
    ms_rc stop(){}
    ms_rc pause(){}
    ms_rc resume(){}
    ms_rc start(const AxzDict& in_dict, AxzDict& out_dict);
    ms_rc test(const AxzDict& in_dict, AxzDict& out_dict);

private:
    ms_rc _onSignalCome(const AxzDict& in_dict);

private:
    FileScanResult                                  _filesResult;
    std::time_t                                     _start_time;
    std::unordered_set<std::wstring>                _files;
    AxzDict                                            _scanConfig;
};


#endif
