#ifndef __CalculateHash_h__
#define __CalculateHash_h__

#include "../../ms_return_codes.h"
#include <cstdint>
#include <memory>

enum AxzUtilsHashType: std::uint8_t
{
	AXZ_SHA_256 = 1,
	AXZ_SHA_384,
	AXZ_SHA_512,
	AXZ_MD_4,
	AXZ_MD_5
};

class _axz_hash_impl;

class  AxzUtilsShamd
{
public:
    AxzUtilsShamd( AxzUtilsHashType in_hash_type );
    ~AxzUtilsShamd();
    
    ms_rc hexCodeOfBytes( const axz_bytes& in_bytes, axz_wstring& out_code );
    ms_rc hexCodeOfFile( const axz_wstring& in_path, axz_wstring& out_code );

    ms_rc hexCodeOfBytesR( const axz_bytes& in_bytes, axz_string& out_code );    

private:    
    std::shared_ptr<_axz_hash_impl> m_impl;
};

class  AxzUtilsHmac
{
public:
    AxzUtilsHmac( AxzUtilsHashType in_hash_type );
    ~AxzUtilsHmac();

    ms_rc hexCodeOfBytes( const axz_bytes& in_key, const axz_bytes& in_data, axz_bytes& out_code );
    ms_rc hexCodeOfBytesR( const axz_bytes& in_key, const axz_bytes& in_data, axz_bytes& out_code );

private:
    std::shared_ptr<_axz_hash_impl> m_impl;
};

#endif